<template>
  <div class="bg-[#F4F5F7] w-full h-[185px] rounded-[8px] py-[20px] px-[16px] mb-[15px]">
    <div class="flex flex-col gap-[20px]">
      <div class="hover-svg-fill flex justify-between items-center">
        <span class="font-medium text-[16px]">{{ currentClient.name }}</span>
        <svg
          width="14"
          height="16"
          viewBox="0 0 14 16"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          class="cursor-pointer"
          @click="removeClientFromCard"
        >
          <path
            d="M5.92308 2.64286H8.07692C8.07692 2.3587 7.96346 2.08617 7.7615 1.88524C7.55954 1.68431 7.28562 1.57143 7 1.57143C6.71438 1.57143 6.44046 1.68431 6.2385 1.88524C6.03654 2.08617 5.92308 2.3587 5.92308 2.64286ZM4.84615 2.64286C4.84615 2.07454 5.07308 1.52949 5.477 1.12763C5.88093 0.725765 6.42876 0.5 7 0.5C7.57124 0.5 8.11907 0.725765 8.523 1.12763C8.92692 1.52949 9.15385 2.07454 9.15385 2.64286H13.4615C13.6043 2.64286 13.7413 2.6993 13.8423 2.79976C13.9433 2.90023 14 3.03649 14 3.17857C14 3.32065 13.9433 3.45691 13.8423 3.55738C13.7413 3.65784 13.6043 3.71429 13.4615 3.71429H12.8542L11.5565 13.1836C11.4684 13.8253 11.1497 14.4135 10.6593 14.8394C10.1688 15.2653 9.5399 15.5 8.88892 15.5H5.11108C4.4601 15.5 3.83116 15.2653 3.34072 14.8394C2.85028 14.4135 2.53155 13.8253 2.44354 13.1836L1.14585 3.71429H0.538462C0.395653 3.71429 0.258693 3.65784 0.157712 3.55738C0.0567306 3.45691 0 3.32065 0 3.17857C0 3.03649 0.0567306 2.90023 0.157712 2.79976C0.258693 2.6993 0.395653 2.64286 0.538462 2.64286H4.84615ZM5.92308 6.39286C5.92308 6.25078 5.86635 6.11452 5.76537 6.01405C5.66438 5.91358 5.52742 5.85714 5.38462 5.85714C5.24181 5.85714 5.10485 5.91358 5.00387 6.01405C4.90288 6.11452 4.84615 6.25078 4.84615 6.39286V11.75C4.84615 11.8921 4.90288 12.0283 5.00387 12.1288C5.10485 12.2293 5.24181 12.2857 5.38462 12.2857C5.52742 12.2857 5.66438 12.2293 5.76537 12.1288C5.86635 12.0283 5.92308 11.8921 5.92308 11.75V6.39286ZM8.61539 5.85714C8.75819 5.85714 8.89515 5.91358 8.99614 6.01405C9.09712 6.11452 9.15385 6.25078 9.15385 6.39286V11.75C9.15385 11.8921 9.09712 12.0283 8.99614 12.1288C8.89515 12.2293 8.75819 12.2857 8.61539 12.2857C8.47258 12.2857 8.33562 12.2293 8.23463 12.1288C8.13365 12.0283 8.07692 11.8921 8.07692 11.75V6.39286C8.07692 6.25078 8.13365 6.11452 8.23463 6.01405C8.33562 5.91358 8.47258 5.85714 8.61539 5.85714ZM3.51077 13.0389C3.56362 13.4239 3.75485 13.7768 4.04906 14.0322C4.34328 14.2877 4.72056 14.4285 5.11108 14.4286H8.88892C9.27963 14.4288 9.65717 14.2881 9.95161 14.0326C10.246 13.7771 10.4374 13.4241 10.4903 13.0389L11.7675 3.71429H2.23246L3.51077 13.0389Z"
            fill="#7E7E80"
          />
        </svg>
      </div>
      <div class="flex flex-col gap-[12px] text-[#6A6A6C] text-[15px]">
        <span>
          <span class="font-medium text-[#424242]">Почта:</span> {{ currentClient.email }}
        </span>
        <span>
          <span class="font-medium text-[#424242]">Телефон:</span> {{ currentClient.phone }}
        </span>
      </div>
      <div class="flex justify-between">
        <button
          v-if="showCallButton"
          class="w-[150px] h-[31px] border-[1px] border-[#0000001F] rounded-[8px] text-[#424242] text-[13px] flex items-center justify-center gap-[6px] hover:bg-[#ffffff] hover:text-[#007BE5] disabled:bg-[#a3a3a362]"
          :disabled="disableButton"
          @click="callClient"
        >
          <svg
            width="14"
            height="13"
            viewBox="0 0 14 13"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M7.60171 5.24457L11.9121 0.928572H8.85714V2.7306e-07H13.5V4.64286H12.5714V1.58786L8.25543 5.89921L7.60171 5.2455V5.24457ZM10.6706 7.6245C11.0538 7.62451 11.4215 7.77566 11.6939 8.04514C11.7961 8.14728 11.9094 8.25314 12.0347 8.36457L12.434 8.72021C12.5733 8.84557 12.7042 8.9765 12.8249 9.11114C12.9456 9.24671 13.0599 9.38507 13.1666 9.52528C13.2725 9.66457 13.3524 9.815 13.4053 9.97471C13.4591 10.1344 13.4907 10.2941 13.5 10.4539C13.4996 10.8367 13.3485 11.204 13.0794 11.4762C12.8324 11.7232 12.6104 11.9405 12.4117 12.1299C12.2235 12.3105 12.0169 12.4708 11.7951 12.6081C11.5816 12.7381 11.3429 12.8356 11.0774 12.8988C10.7699 12.9662 10.4561 13.0001 10.1414 13C9.59062 12.9964 9.0433 12.9132 8.51636 12.753C7.94122 12.5811 7.38447 12.3528 6.85421 12.0714C6.28748 11.7712 5.74674 11.4242 5.23757 11.0342C4.70922 10.632 4.20967 10.1932 3.74257 9.72121C3.27364 9.24764 2.83814 8.74621 2.437 8.21971C2.04907 7.71391 1.70664 7.17479 1.41371 6.60864C1.14128 6.08155 0.91809 5.53042 0.747 4.96229C0.587632 4.44502 0.504426 3.90731 0.5 3.36607C0.5 2.99836 0.531571 2.6845 0.594714 2.42264C0.653259 2.17207 0.751037 1.93233 0.884429 1.71229C1.01443 1.49871 1.17507 1.29443 1.36357 1.09571C1.55207 0.897 1.77214 0.672286 2.02286 0.420643C2.29549 0.150937 2.66357 -0.000234505 3.04707 2.7306e-07C3.2885 2.7306e-07 3.52064 0.0650003 3.7435 0.195C3.96636 0.326857 4.18179 0.485643 4.38979 0.675072C4.59686 0.863572 4.78907 1.06136 4.96271 1.26936C5.13636 1.47736 5.30071 1.65657 5.45486 1.80607C5.72434 2.07848 5.87549 2.44618 5.8755 2.82936C5.87882 3.00317 5.84725 3.17589 5.78264 3.33729C5.72386 3.48036 5.64575 3.6147 5.5505 3.73657C5.45761 3.85326 5.35544 3.96226 5.245 4.0625C5.13357 4.16464 5.03236 4.26121 4.94043 4.35314C4.8551 4.43756 4.77509 4.52718 4.70086 4.6215C4.63506 4.70327 4.60168 4.8064 4.60707 4.91121C4.60707 4.96971 4.65071 5.06164 4.73707 5.187C4.84919 5.34379 4.97042 5.49386 5.10014 5.63643C5.46077 6.04163 5.83585 6.43374 6.22464 6.812C6.44193 7.02557 6.65271 7.22986 6.85607 7.42857C7.0585 7.62729 7.25536 7.81578 7.44386 7.995C7.63236 8.17328 7.79207 8.32557 7.92207 8.45186C8.05207 8.57721 8.15421 8.67471 8.22664 8.74157C8.30936 8.82735 8.4202 8.88048 8.53889 8.89122C8.65757 8.90197 8.77615 8.86961 8.87293 8.80007C8.95929 8.73693 9.04936 8.65893 9.14128 8.56793C9.23321 8.47507 9.327 8.37386 9.42357 8.26243C9.52014 8.151 9.63157 8.04978 9.75786 7.95786C9.88321 7.86593 10.016 7.78607 10.1571 7.71829C10.3189 7.647 10.4951 7.61487 10.6716 7.6245H10.6706ZM10.1414 12.0714C10.4366 12.0714 10.6827 12.0445 10.8814 11.9916C11.0754 11.9403 11.2593 11.8568 11.4256 11.7446C11.5899 11.6331 11.7441 11.5031 11.8899 11.3536C12.0347 11.2032 12.2111 11.0268 12.4191 10.8244C12.5213 10.7222 12.5714 10.6015 12.5714 10.4613C12.5714 10.3981 12.5324 10.309 12.4554 10.192C12.3641 10.0576 12.2671 9.92717 12.1647 9.80107C12.041 9.64727 11.9076 9.5015 11.7654 9.36464C11.6169 9.22071 11.4711 9.087 11.3309 8.96628C11.2088 8.85956 11.0805 8.76033 10.9464 8.66914C10.8304 8.59207 10.7384 8.55307 10.6706 8.55307C10.5667 8.55385 10.4656 8.58659 10.3809 8.64686C10.2832 8.71445 10.1929 8.79227 10.1116 8.879C10.0253 8.97186 9.93057 9.07307 9.82936 9.1845C9.72721 9.29593 9.61579 9.39714 9.49507 9.48907C9.37436 9.581 9.24157 9.66086 9.09579 9.72864C8.93636 9.79885 8.76278 9.83096 8.58879 9.82243C8.39827 9.82363 8.20947 9.78642 8.03366 9.71303C7.85784 9.63964 7.69862 9.53158 7.5655 9.39528L4.10564 5.93357C3.97204 5.8009 3.866 5.64311 3.79364 5.46929C3.72038 5.29184 3.68101 5.10223 3.67757 4.91029C3.67757 4.72179 3.70914 4.55464 3.77136 4.40979C3.8345 4.26493 3.91157 4.12936 4.0035 4.00307C4.09636 3.87771 4.19757 3.76907 4.309 3.67714C4.42043 3.58521 4.52164 3.48864 4.61357 3.3865C4.7055 3.28529 4.78536 3.19614 4.85314 3.11814C4.92154 3.0378 4.95527 2.93361 4.94693 2.82843C4.94693 2.76529 4.90793 2.67614 4.83086 2.55914C4.74086 2.42647 4.64416 2.29848 4.54114 2.17564C4.41493 2.02432 4.28168 1.87899 4.14186 1.74014C4.00301 1.60031 3.85769 1.46707 3.70636 1.34086C3.58043 1.23576 3.44967 1.13661 3.3145 1.04371C3.19379 0.961072 3.10464 0.923 3.04614 0.927643C2.97741 0.92644 2.90915 0.939331 2.84559 0.965523C2.78203 0.991714 2.72451 1.03065 2.67657 1.07993C2.50121 1.25527 2.32478 1.42954 2.14729 1.60271C2.00052 1.74309 1.86915 1.89873 1.75543 2.067C1.64536 2.23352 1.56436 2.41752 1.51586 2.61114C1.45803 2.85107 1.42873 3.09699 1.42857 3.34379C1.42857 3.80807 1.50286 4.28629 1.65329 4.77936C1.81303 5.29649 2.02199 5.79711 2.27729 6.27436C2.54379 6.77671 2.86229 7.26607 3.23464 7.73964C3.607 8.21321 4.00629 8.66543 4.4325 9.09536C5.26703 9.93982 6.21979 10.6586 7.26093 11.2292C7.72937 11.4847 8.22287 11.6914 8.73364 11.8458C9.19014 11.9858 9.66395 12.0615 10.1414 12.0705V12.0714Z"
              fill="currentColor"
            />
          </svg>

          <span>
            Звонок
          </span>
        </button>
        <button
          class="h-[31px] border-[1px] border-[#0000001F] rounded-[8px] text-[#424242] text-[13px] flex items-center justify-center gap-[6px] hover:bg-[#ffffff] hover:text-[#007BE5]"
          :class="showCallButton ? 'w-[150px]' : 'w-full'"
          @click="clickShowClientModal"
        >
          Открыть контакт
        </button>
      </div>
    </div>
  </div>
</template>
<script>
import { stripPhoneNumber } from '@/helpers/functions'
import * as CORP_MEGAFON from '@/store/actions/integrations/corpoMegafonInt'

export default {
  props: {
    currentClient: {
      type: Object,
      default: () => {}
    }
  },
  emits: ['clickShowClientModalEmit', 'removeClientFromCardEmit'],
  data () {
    return {
      disableButton: false
    }
  },
  computed: {
    user () {
      return this.$store.state.user.user
    },
    showCallButton () {
      return this.currentClient.phone && this.$store.getters.isMegafonCanCall
    }
  },
  methods: {
    clickShowClientModal () {
      this.$emit('clickShowClientModalEmit')
    },
    removeClientFromCard () {
      this.$emit('removeClientFromCardEmit')
    },
    callClient () {
      this.disableButton = true
      const phone = stripPhoneNumber(this.currentClient.phone)
      this.$store.dispatch(CORP_MEGAFON.CALL_CLIENT, phone)
      setTimeout(() => {
        this.disableButton = false
      }, 2000)
    }
  }
}
</script>
<style scoped>
.hover-svg-fill svg:hover path {
  fill: #EF4444;
  transition: all ease 0.3s;
}

</style>
