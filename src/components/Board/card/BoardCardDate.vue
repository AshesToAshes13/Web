<template>
  <svg
    width="16"
    height="16"
    viewBox="0 0 16 16"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M4.33328 1.47884C4.33328 1.15668 4.59445 0.895508 4.91662 0.895508C5.23879 0.895508 5.49996 1.15668 5.49996 1.47884V1.89551H10.5V1.47884C10.5 1.15668 10.7612 0.895508 11.0833 0.895508C11.4055 0.895508 11.6667 1.15668 11.6667 1.47884V1.89551H12.6667C13.403 1.89551 14 2.49247 14 3.22885V11.8956C14 12.6319 13.403 13.2289 12.6667 13.2289H3.33328C2.5969 13.2289 1.99994 12.6319 1.99994 11.8956V3.22885C1.99994 2.49247 2.5969 1.89551 3.33328 1.89551H4.33328V1.47884ZM10.5 2.81218V3.47885C10.5 3.80102 10.7612 4.06219 11.0833 4.06219C11.4055 4.06219 11.6667 3.80102 11.6667 3.47886V2.81218H12.6667C12.8968 2.81218 13.0833 2.99873 13.0833 3.22885V11.8956C13.0833 12.1257 12.8968 12.3122 12.6667 12.3122H3.33328C3.10316 12.3122 2.91661 12.1257 2.91661 11.8956V3.22885C2.91661 2.99873 3.10316 2.81218 3.33328 2.81218H4.33328V3.47885C4.33328 3.80102 4.59445 4.06219 4.91662 4.06219C5.23879 4.06219 5.49996 3.80102 5.49996 3.47885V2.81218H10.5ZM4.86981 5.18357C4.4564 5.18357 4.12127 5.52632 4.12127 5.94913C4.12127 6.37193 4.4564 6.71468 4.86981 6.71468C5.28322 6.71468 5.61835 6.37193 5.61835 5.94913C5.61835 5.52632 5.28322 5.18357 4.86981 5.18357ZM8.28586 5.94913C8.28586 5.52632 8.621 5.18357 9.0344 5.18357C9.44781 5.18357 9.78294 5.52632 9.78294 5.94913C9.78294 6.37193 9.44781 6.71468 9.0344 6.71468C8.621 6.71468 8.28586 6.37193 8.28586 5.94913ZM8.28586 8.09267C8.28586 7.66987 8.621 7.32712 9.0344 7.32712C9.44781 7.32712 9.78294 7.66987 9.78294 8.09267C9.78294 8.51547 9.44781 8.85822 9.0344 8.85822C8.621 8.85822 8.28586 8.51547 8.28586 8.09267ZM8.28586 10.2362C8.28586 9.81341 8.621 9.47066 9.0344 9.47066C9.44781 9.47066 9.78294 9.81341 9.78294 10.2362C9.78294 10.659 9.44781 11.0018 9.0344 11.0018C8.621 11.0018 8.28586 10.659 8.28586 10.2362ZM10.3818 5.94913C10.3818 5.52632 10.7169 5.18357 11.1303 5.18357C11.5437 5.18357 11.8789 5.52632 11.8789 5.94913C11.8789 6.37193 11.5437 6.71468 11.1303 6.71468C10.7169 6.71468 10.3818 6.37193 10.3818 5.94913ZM10.3818 8.09267C10.3818 7.66987 10.7169 7.32712 11.1303 7.32712C11.5437 7.32712 11.8789 7.66987 11.8789 8.09267C11.8789 8.51547 11.5437 8.85822 11.1303 8.85822C10.7169 8.85822 10.3818 8.51547 10.3818 8.09267ZM10.3818 10.2362C10.3818 9.81341 10.7169 9.47066 11.1303 9.47066C11.5437 9.47066 11.8789 9.81341 11.8789 10.2362C11.8789 10.659 11.5437 11.0018 11.1303 11.0018C10.7169 11.0018 10.3818 10.659 10.3818 10.2362ZM4.12127 8.09267C4.12127 7.66987 4.4564 7.32712 4.86981 7.32712C5.28322 7.32712 5.61835 7.66987 5.61835 8.09267C5.61835 8.51547 5.28322 8.85822 4.86981 8.85822C4.4564 8.85822 4.12127 8.51547 4.12127 8.09267ZM4.12127 10.2362C4.12127 9.81341 4.4564 9.47066 4.86981 9.47066C5.28322 9.47066 5.61835 9.81341 5.61835 10.2362C5.61835 10.659 5.28322 11.0018 4.86981 11.0018C4.4564 11.0018 4.12127 10.659 4.12127 10.2362ZM6.21718 5.94913C6.21718 5.52632 6.55232 5.18357 6.96572 5.18357C7.37913 5.18357 7.71426 5.52632 7.71426 5.94913C7.71426 6.37193 7.37913 6.71468 6.96572 6.71468C6.55232 6.71468 6.21718 6.37193 6.21718 5.94913ZM6.21718 8.09267C6.21718 7.66987 6.55232 7.32712 6.96572 7.32712C7.37913 7.32712 7.71426 7.66987 7.71426 8.09267C7.71426 8.51547 7.37913 8.85822 6.96572 8.85822C6.55232 8.85822 6.21718 8.51547 6.21718 8.09267ZM6.21718 10.2362C6.21718 9.81341 6.55232 9.47066 6.96572 9.47066C7.37913 9.47066 7.71426 9.81341 7.71426 10.2362C7.71426 10.659 7.37913 11.0018 6.96572 11.0018C6.55232 11.0018 6.21718 10.659 6.21718 10.2362Z"
      fill="#7e7e80"
    />
  </svg>
  <span
    class="text-[10px] leading-[12px] text-[#7e7e80] font-['Roboto'] mx-0.5"
  >
    {{ date }}
  </span>
</template>

<script>
export default {
  props: {
    dateMove: {
      type: String,
      default: ''
    }
  },
  computed: {
    date () {
      const today = new Date()
      today.setHours(0, 0, 0, 0)
      // добавляем Z в конец, чтобы он посчитал что это UTC время
      let dateMoveString = this.dateMove
      if (dateMoveString[dateMoveString.length - 1] !== 'Z') {
        dateMoveString = dateMoveString + 'Z'
      }
      const dateMove = new Date(dateMoveString)
      const dateMoveTime = dateMove.toLocaleString('default', {
        hour: 'numeric',
        minute: 'numeric'
      })
      dateMove.setHours(0, 0, 0, 0)

      const oneDay = 1000 * 60 * 60 * 24
      const diffInTime = today.getTime() - dateMove.getTime()
      const diffInDays = Math.round(diffInTime / oneDay)

      if (diffInDays === 0) {
        // сегодня
        return dateMoveTime
      }
      if (diffInDays === 1) {
        // вчера
        return 'Вчера'
      }
      if (diffInDays > 1 && diffInDays < 8) {
        // на неделе
        const dateMoveWeekday = dateMove.toLocaleString('default', {
          weekday: 'short'
        })
        return (
          dateMoveWeekday.slice(0, 1).toUpperCase() + dateMoveWeekday.slice(1)
        )
      }
      const month = dateMove
        .toLocaleString('default', { month: 'short' })
        .slice(0, 3)
      const dayNum = dateMove.getDate()
      const day = (dayNum < 10 ? '0' : '') + dayNum
      if (today.getFullYear() !== dateMove.getFullYear()) {
        return `${day} ${month} ${dateMove.getFullYear()}`
      }
      return `${day} ${month}`
    }
  }
}
</script>
