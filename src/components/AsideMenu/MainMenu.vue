<template>
  <InspectorLimit
    v-if="showFreeModal"
    @cancel="showFreeModal = false"
  />
  <InspectorModalBox
    v-model="showInspector"
    button="warning"
    has-button
    has-cancel
    button-label="Delete"
  />
  <aside
    id="aside"
    style="overflow-x:hidden; scrollbar-width: none;"
    class="w-[292px] fixed top-0 h-screen transition-position bg-[#f4f5f7] font-SfProDisplayNormal text-sm xl:left-0 z-30"
    :class="isAsideMobileExpanded ? 'left-0' : '-left-full'"
  >
    <div class="px-[16px] pt-[15px]">
      <AsideMenuListItem
        class="mb-[16px]"
        :selected="isPathSelected('account')"
        :title="user?.current_user_name"
        @click="changeTab('account')"
      >
        <img
          class="rounded-[8px] h-[30px] w-[30px] border-2 border-white"
          :src="user?.foto_link"
        >
      </AsideMenuListItem>
      <router-link to="/doitnow">
        <AsideMenuListItem
          :selected="isPathSelected('doitnow')"
          title="Очередь"
          @click="selectTab('doitnow')"
        >
          <svg
            width="30"
            height="30"
            viewBox="0 0 30 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M5 6.89471C5 6.65742 5.08975 6.42985 5.2495 6.26206C5.40925 6.09426 5.62593 6 5.85185 6H22.5926C22.8185 6 23.0352 6.09426 23.1949 6.26206C23.3547 6.42985 23.4444 6.65742 23.4444 6.89471C23.4444 7.13201 23.3547 7.35958 23.1949 7.52737C23.0352 7.69517 22.8185 7.78943 22.5926 7.78943H5.85185C5.62593 7.78943 5.40925 7.69517 5.2495 7.52737C5.08975 7.35958 5 7.13201 5 6.89471ZM14.0741 13.1577H5.85185C5.62593 13.1577 5.40925 13.252 5.2495 13.4198C5.08975 13.5876 5 13.8151 5 14.0524C5 14.2897 5.08975 14.5173 5.2495 14.6851C5.40925 14.8529 5.62593 14.9471 5.85185 14.9471H14.0741C14.3 14.9471 14.5167 14.8529 14.6764 14.6851C14.8362 14.5173 14.9259 14.2897 14.9259 14.0524C14.9259 13.8151 14.8362 13.5876 14.6764 13.4198C14.5167 13.252 14.3 13.1577 14.0741 13.1577ZM14.0741 20.3154H5.85185C5.62593 20.3154 5.40925 20.4097 5.2495 20.5775C5.08975 20.7453 5 20.9729 5 21.2102C5 21.4474 5.08975 21.675 5.2495 21.8428C5.40925 22.0106 5.62593 22.1049 5.85185 22.1049H14.0741C14.3 22.1049 14.5167 22.0106 14.6764 21.8428C14.8362 21.675 14.9259 21.4474 14.9259 21.2102C14.9259 20.9729 14.8362 20.7453 14.6764 20.5775C14.5167 20.4097 14.3 20.3154 14.0741 20.3154ZM26 17.6313C26.0009 17.784 25.964 17.9343 25.8931 18.0676C25.8222 18.2009 25.7196 18.3126 25.5954 18.3918L18.7805 22.8654C18.6517 22.9494 18.5038 22.9958 18.3522 22.9997C18.2006 23.0037 18.0507 22.965 17.918 22.8877C17.7862 22.8091 17.6764 22.6953 17.5997 22.5578C17.5231 22.4204 17.4823 22.2642 17.4815 22.1049V13.1577C17.4816 12.9985 17.5222 12.8423 17.5991 12.7051C17.6759 12.5679 17.7862 12.4547 17.9186 12.3772C18.051 12.2997 18.2006 12.2607 18.3522 12.2642C18.5037 12.2677 18.6516 12.3136 18.7805 12.3972L25.5954 16.8708C25.7196 16.95 25.8222 17.0617 25.8931 17.195C25.964 17.3283 26.0009 17.4786 26 17.6313ZM23.5403 17.6313L19.1852 14.7682V20.4944L23.5403 17.6313Z"
              fill="currentColor"
            />
          </svg>
        </AsideMenuListItem>
      </router-link>
      <AsideMenuListItem
        :selected="isPathSelected('tasks')"
        title="Задачи"
        @click="changeTab('tasks')"
      >
        <svg
          width="30"
          height="30"
          viewBox="0 0 30 30"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M6.44542 5.83331H12.8532C13.1941 5.83331 13.4651 6.10431 13.4651 6.44524V12.853C13.4651 13.1939 13.1941 13.4649 12.8532 13.4649H6.44542C6.10449 13.4649 5.8335 13.1939 5.8335 12.853V6.44524C5.8335 6.10431 6.10449 5.83331 6.44542 5.83331ZM7.34583 7.34565V11.9526H11.9528V7.34565H7.34583ZM6.44542 16.035H12.8532C13.1941 16.035 13.4651 16.306 13.4651 16.647V23.0547C13.4651 23.3957 13.1941 23.6667 12.8532 23.6667H6.44542C6.10449 23.6667 5.8335 23.3957 5.8335 23.0547V16.647C5.8335 16.306 6.10449 16.035 6.44542 16.035ZM7.34583 17.5474V22.1543H11.9528V17.5474H7.34583ZM20.6071 16.035H19.0948V19.0947H16.0352V20.607H19.0948V23.6667H20.6071V20.607H23.6668V19.0947H20.6071V16.035ZM16.6471 5.83331H23.0548C23.3958 5.83331 23.6668 6.10431 23.6668 6.44524V12.853C23.6668 13.1939 23.3958 13.4649 23.0548 13.4649H16.6471C16.3062 13.4649 16.0352 13.1939 16.0352 12.853V6.44524C16.0352 6.10431 16.3062 5.83331 16.6471 5.83331ZM17.5475 7.34565V11.9526H22.1544V7.34565H17.5475Z"
            fill="currentColor"
          />
        </svg>
      </AsideMenuListItem>
      <router-link
        to="/reglaments"
      >
        <AsideMenuListItem
          :selected="isPathSelected('reglaments')"
          title="Регламенты"
          @click="selectTab('reglaments')"
        >
          <svg
            width="30"
            height="30"
            viewBox="0 0 30 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M26.2803 18.4697L24.0303 16.2197C23.8896 16.0791 23.6989 16.0002 23.5 16.0002C23.3011 16.0002 23.1104 16.0791 22.9697 16.2197L16 23.1895V26.5H19.3105L26.2803 19.5303C26.4209 19.3896 26.4998 19.1989 26.4998 19C26.4998 18.8011 26.4209 18.6104 26.2803 18.4697ZM18.6895 25H17.5V23.8105L21.25 20.0605L22.4395 21.25L18.6895 25ZM23.5 20.1895L22.3105 19L23.5 17.8105L24.6895 19L23.5 20.1895ZM10 16H17.5V17.5H10V16ZM10 11.5H19V13H10V11.5Z"
              fill="currentColor"
            />
            <path
              d="M23.5 7C23.4996 6.6023 23.3414 6.221 23.0602 5.93978C22.779 5.65856 22.3977 5.5004 22 5.5H7.00001C6.6023 5.5004 6.221 5.65856 5.93978 5.93978C5.65856 6.221 5.5004 6.6023 5.50001 7V16.75C5.49833 18.2458 5.90404 19.7137 6.67359 20.9964C7.44313 22.279 8.54745 23.3278 9.868 24.0302L13.75 26.1002V24.4L10.5745 22.7065C9.49402 22.1318 8.59042 21.2737 7.96069 20.2243C7.33095 19.1749 6.99884 17.9738 7.00001 16.75V7H22V13.75H23.5V7Z"
              fill="currentColor"
            />
          </svg>
        </AsideMenuListItem>
      </router-link>
      <AsideMenuListItem
        :selected="isPathSelected('project')"
        title="Проекты"
        @click="changeTab('project')"
      >
        <svg
          width="30"
          height="30"
          viewBox="0 0 30 30"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M23.3813 9.4868V8.39736C23.3813 7.3868 22.5646 6.56356 21.562 6.56356H14.0645L13.8396 6.18891C13.7026 5.97201 13.463 5.83398 13.2087 5.83398H7.65284C6.65024 5.83398 5.8335 6.65722 5.8335 7.66779V21.5002C5.8335 22.5107 6.65024 23.334 7.65284 23.334H23.1808C24.1834 23.334 25.0001 22.5107 25.0001 21.5002V11.3107C25.005 10.3643 24.291 9.58539 23.3813 9.4868ZM7.31049 7.66779C7.31049 7.47553 7.46699 7.31779 7.65773 7.31779H12.7978L14.7933 10.6009C14.9253 10.8178 15.1649 10.9558 15.4242 10.9558H23.1906C23.3813 10.9558 23.5378 11.1136 23.5378 11.3058V21.5002C23.5378 21.6924 23.3813 21.8502 23.1906 21.8502H7.65284C7.4621 21.8502 7.3056 21.6924 7.3056 21.5002V7.66779H7.31049ZM21.9043 9.47201H15.8301L14.9644 8.04736H21.5571C21.7478 8.04736 21.9043 8.20511 21.9043 8.39736V9.47201Z"
            fill="currentColor"
          />
        </svg>
      </AsideMenuListItem>
      <AsideMenuListItem
        :selected="isPathSelected('board')"
        title="Доски"
        @click="changeTab('board')"
      >
        <svg
          width="30"
          height="30"
          viewBox="0 0 30 30"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M6.5 24.9694C5.67347 24.9694 5 24.3061 5 23.4898V8.85714C5 8.04082 5.67347 7.37755 6.5 7.37755H10.102V6.32653C10.102 5.96939 10.3878 5.68367 10.7449 5.68367H12.7347L12.7857 5.55102C13.1122 4.62245 14.0102 4 15 4C15.9898 4 16.8878 4.62245 17.2143 5.55102L17.2653 5.68367H19.2551C19.6122 5.68367 19.898 5.96939 19.898 6.32653V7.37755H23.5C24.3265 7.37755 25 8.04082 25 8.85714V23.4898C25 24.3061 24.3265 24.9694 23.5 24.9694H6.5ZM6.29592 23.6939H23.7143V8.65306H19.898V9.70408C19.898 10.0612 19.6122 10.3469 19.2551 10.3469H10.7449C10.3878 10.3469 10.102 10.0612 10.102 9.70408V8.65306H6.29592V23.6939ZM11.398 9.06122H18.6122V6.96939H16.7041C16.3469 6.96939 16.0612 6.68367 16.0612 6.32653C16.0612 5.7449 15.5918 5.27551 15.0102 5.27551C14.4286 5.27551 13.949 5.7449 13.949 6.32653C13.949 6.68367 13.6633 6.96939 13.3061 6.96939H11.398V9.06122Z"
            fill="#606061"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M8 14.75C8 14.3358 8.33579 14 8.75 14H11.25C11.6642 14 12 14.3358 12 14.75C12 15.1642 11.6642 15.5 11.25 15.5H8.75C8.33579 15.5 8 15.1642 8 14.75ZM13 14.75C13 14.3358 13.3358 14 13.75 14H16.25C16.6642 14 17 14.3358 17 14.75C17 15.1642 16.6642 15.5 16.25 15.5H13.75C13.3358 15.5 13 15.1642 13 14.75ZM18.75 14C18.3358 14 18 14.3358 18 14.75C18 15.1642 18.3358 15.5 18.75 15.5H21.25C21.6642 15.5 22 15.1642 22 14.75C22 14.3358 21.6642 14 21.25 14H18.75Z"
            fill="#606061"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M8 19.75C8 19.3358 8.33579 19 8.75 19H11.25C11.6642 19 12 19.3358 12 19.75C12 20.1642 11.6642 20.5 11.25 20.5H8.75C8.33579 20.5 8 20.1642 8 19.75ZM13 19.75C13 19.3358 13.3358 19 13.75 19H16.25C16.6642 19 17 19.3358 17 19.75C17 20.1642 16.6642 20.5 16.25 20.5H13.75C13.3358 20.5 13 20.1642 13 19.75ZM18.75 19C18.3358 19 18 19.3358 18 19.75C18 20.1642 18.3358 20.5 18.75 20.5H21.25C21.6642 20.5 22 20.1642 22 19.75C22 19.3358 21.6642 19 21.25 19H18.75Z"
            fill="#606061"
          />
        </svg>
      </AsideMenuListItem>
      <router-link
        to="/clients?page=1"
      >
        <AsideMenuListItem
          :selected="isPathSelected('clients')"
          title="Контакты"
          @click="selectTab('clients')"
        >
          <svg
            width="30"
            height="30"
            viewBox="0 0 30 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M6 23.25V6.75C6 6.02065 6.28095 5.32118 6.78105 4.80546C7.28115 4.28973 7.95942 4 9.66667 4H21.3333C22.0406 4 22.7189 4.28973 23.219 4.80546C23.719 5.32118 24 6.02065 24 6.75V21.875C24 22.2397 23.8595 22.5894 23.6095 22.8473C23.3594 23.1051 23.0203 23.25 22.6667 23.25H7.33333C7.33333 23.6147 7.47381 23.9644 7.72386 24.2223C7.97391 24.4801 8.31304 24.625 9.66667 24.625H23.3333C23.5101 24.625 23.6797 24.6974 23.8047 24.8264C23.9298 24.9553 24 25.1302 24 25.3125C24 25.4948 23.9298 25.6697 23.8047 25.7986C23.6797 25.9276 23.5101 26 23.3333 26H9.66667C7.95942 26 7.28115 25.7103 6.78105 25.1945C6.28095 24.6788 6 23.9793 6 23.25ZM22.2761 5.77773C22.0261 5.51987 21.687 5.375 21.3333 5.375H9.66667C8.31304 5.375 7.97391 5.51987 7.72386 5.77773C7.47381 6.03559 7.33333 6.38533 7.33333 6.75V21.875H22.6667V6.75C22.6667 6.38533 22.5262 6.03559 22.2761 5.77773ZM15.8 11.1429C15.8 11.4186 15.697 11.6678 15.5369 11.8393C15.3795 12.008 15.1844 12.0857 15 12.0857C14.8156 12.0857 14.6205 12.008 14.4631 11.8393C14.303 11.6678 14.2 11.4186 14.2 11.1429C14.2 10.8671 14.303 10.6179 14.4631 10.4464C14.6205 10.2777 14.8156 10.2 15 10.2C15.1844 10.2 15.3795 10.2777 15.5369 10.4464C15.697 10.6179 15.8 10.8671 15.8 11.1429ZM12.2 16.1429V15.9143H17.8V16.1429C17.8 16.608 17.6268 17.0389 17.3417 17.3444C17.0592 17.647 16.6946 17.8 16.3333 17.8H13.6667C13.3054 17.8 12.9408 17.647 12.6583 17.3444C12.3732 17.0389 12.2 16.608 12.2 16.1429ZM17 11.1429C17 11.7112 16.7893 12.2562 16.4142 12.6581C16.0391 13.0599 15.5304 13.2857 15 13.2857C14.4696 13.2857 13.9609 13.0599 13.5858 12.6581C13.2107 12.2562 13 11.7112 13 11.1429C13 10.5745 13.2107 10.0295 13.5858 9.62763C13.9609 9.22576 14.4696 9 15 9C15.5304 9 16.0391 9.22576 16.4142 9.62763C16.7893 10.0295 17 10.5745 17 11.1429ZM11 15.7857V16.1429C11 16.9006 11.281 17.6273 11.781 18.1632C12.2811 18.699 12.9594 19 13.6667 19H16.3333C17.0406 19 17.7189 18.699 18.219 18.1632C18.719 17.6273 19 16.9006 19 16.1429V15.7857C19 15.5016 18.8946 15.229 18.7071 15.0281C18.5196 14.8272 18.2652 14.7143 18 14.7143H12C11.7348 14.7143 11.4804 14.8272 11.2929 15.0281C11.1054 15.229 11 15.5016 11 15.7857Z"
              fill="#606061"
            />
          </svg>
        </AsideMenuListItem>
      </router-link>
      <AsideMenuListItem
        :selected="isPathSelected('settings')"
        title="Настройки"
        @click="changeTab('settings')"
      >
        <svg
          width="30"
          height="30"
          viewBox="0 0 30 30"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M12.5304 5.84605C13.255 3.38465 16.745 3.38465 17.4697 5.84605L17.5989 6.2847C17.6495 6.45652 17.738 6.61484 17.8577 6.74805C17.9774 6.88126 18.1255 6.98598 18.291 7.05455C18.4564 7.12311 18.6352 7.15378 18.814 7.14429C18.9929 7.13481 19.1674 7.08542 19.3247 6.99975L19.7262 6.78111C21.98 5.55316 24.4482 8.01869 23.2203 10.2738L23.0003 10.6753C22.9146 10.8326 22.8652 11.0071 22.8557 11.186C22.8462 11.3649 22.8769 11.5436 22.9455 11.7091C23.014 11.8745 23.1188 12.0226 23.252 12.1423C23.3852 12.2621 23.5435 12.3505 23.7153 12.4011L24.154 12.5303C26.6154 13.255 26.6154 16.745 24.154 17.4696L23.7153 17.5989C23.5435 17.6495 23.3852 17.7379 23.252 17.8577C23.1188 17.9774 23.014 18.1254 22.9455 18.2909C22.8769 18.4564 22.8462 18.6351 22.8557 18.814C22.8652 18.9929 22.9146 19.1673 23.0003 19.3246L23.2189 19.7262C24.4482 21.9799 21.9813 24.4482 19.7262 23.2202L19.3247 23.0002C19.1674 22.9146 18.9929 22.8652 18.814 22.8557C18.6352 22.8462 18.4564 22.8769 18.291 22.9454C18.1255 23.014 17.9774 23.1187 17.8577 23.2519C17.738 23.3851 17.6495 23.5435 17.5989 23.7153L17.4697 24.1539C16.745 26.6153 13.255 26.6153 12.5304 24.1539L12.4011 23.7153C12.3505 23.5435 12.2621 23.3851 12.1423 23.2519C12.0226 23.1187 11.8746 23.014 11.7091 22.9454C11.5436 22.8769 11.3649 22.8462 11.186 22.8557C11.0072 22.8652 10.8327 22.9146 10.6754 23.0002L10.2739 23.2189C8.01872 24.4482 5.55319 21.9813 6.77976 19.7262L6.99978 19.3246C7.08545 19.1673 7.13484 18.9929 7.14432 18.814C7.15381 18.6351 7.12314 18.4564 7.05458 18.2909C6.98601 18.1254 6.88129 17.9774 6.74808 17.8577C6.61487 17.7379 6.45655 17.6495 6.28473 17.5989L5.84608 17.4696C3.38468 16.745 3.38468 13.255 5.84608 12.5303L6.28473 12.4011C6.45655 12.3505 6.61487 12.2621 6.74808 12.1423C6.88129 12.0226 6.98601 11.8745 7.05458 11.7091C7.12314 11.5436 7.15381 11.3649 7.14432 11.186C7.13484 11.0071 7.08545 10.8326 6.99978 10.6753L6.78114 10.2738C5.55319 8.02006 8.01872 5.55316 10.2739 6.77973L10.6754 6.99975C10.8327 7.08542 11.0072 7.13481 11.186 7.14429C11.3649 7.15378 11.5436 7.12311 11.7091 7.05455C11.8746 6.98598 12.0226 6.88126 12.1423 6.74805C12.2621 6.61484 12.3505 6.45652 12.4011 6.2847L12.5304 5.84605ZM16.151 6.2352C15.8127 5.087 14.1873 5.087 13.8491 6.2352L13.7198 6.67385C13.6111 7.0423 13.4214 7.38176 13.1645 7.66738C12.9076 7.953 12.59 8.17753 12.2351 8.32453C11.8802 8.47153 11.4969 8.53727 11.1133 8.51695C10.7297 8.49663 10.3555 8.39075 10.0181 8.20707L9.61656 7.98843C8.56462 7.4164 7.41643 8.56597 7.98709 9.61653L8.2071 10.0181C8.39052 10.3554 8.49619 10.7295 8.51638 11.1129C8.53657 11.4964 8.47077 11.8795 8.32378 12.2342C8.1768 12.589 7.95236 12.9063 7.66689 13.1631C7.38142 13.4199 7.04214 13.6097 6.67388 13.7184L6.23523 13.8477C5.08704 14.1859 5.08704 15.8113 6.23523 16.1496L6.67388 16.2788C7.04272 16.3874 7.38255 16.5772 7.66845 16.8343C7.95435 17.0914 8.17907 17.4093 8.32611 17.7645C8.47315 18.1198 8.53878 18.5035 8.51818 18.8874C8.49759 19.2713 8.3913 19.6458 8.2071 19.9833L7.98846 20.3834C7.41643 21.4354 8.566 22.5836 9.61656 22.0129L10.0181 21.7929C10.3555 21.6092 10.7297 21.5034 11.1133 21.483C11.4969 21.4627 11.8802 21.5285 12.2351 21.6755C12.59 21.8225 12.9076 22.047 13.1645 22.3326C13.4214 22.6182 13.6111 22.9577 13.7198 23.3261L13.8491 23.7648C14.1873 24.913 15.8127 24.913 16.151 23.7648L16.2802 23.3275C16.3887 22.9587 16.5784 22.6189 16.8353 22.333C17.0922 22.0471 17.4099 21.8223 17.765 21.6752C18.1201 21.528 18.5037 21.4622 18.8875 21.4826C19.2714 21.503 19.6458 21.609 19.9833 21.7929L20.3835 22.0115C21.4354 22.5836 22.5836 21.434 22.013 20.3834L21.7929 19.9833C21.609 19.6459 21.5029 19.2715 21.4825 18.8877C21.462 18.504 21.5277 18.1205 21.6747 17.7654C21.8217 17.4103 22.0464 17.0926 22.3321 16.8356C22.6179 16.5786 22.9575 16.3889 23.3262 16.2802L23.7648 16.1509C24.913 15.8127 24.913 14.1873 23.7648 13.849L23.3275 13.7198C22.959 13.6112 22.6194 13.4216 22.3336 13.1648C22.0478 12.9079 21.8231 12.5904 21.676 12.2355C21.5288 11.8806 21.463 11.4972 21.4832 11.1135C21.5035 10.7298 21.6093 10.3555 21.7929 10.0181L22.0116 9.61653C22.5836 8.56459 21.434 7.4164 20.3835 7.98706L19.9833 8.20707C19.6459 8.39101 19.2716 8.49709 18.8878 8.51755C18.504 8.53801 18.1205 8.47232 17.7654 8.3253C17.4103 8.17828 17.0926 7.95366 16.8357 7.6679C16.5787 7.38214 16.3889 7.04249 16.2802 6.67385L16.151 6.2352ZM13.2919 10.8771C13.8334 10.6528 14.4139 10.5374 15 10.5374C16.1838 10.5374 17.3191 11.0076 18.1562 11.8447C18.9933 12.6818 19.4635 13.8171 19.4635 15.0009C19.4635 16.1847 18.9933 17.32 18.1562 18.1571C17.3191 18.9942 16.1838 19.4644 15 19.4644C14.4139 19.4644 13.8334 19.349 13.2919 19.1247C12.7504 18.9004 12.2583 18.5716 11.8438 18.1571C11.4294 17.7426 11.1006 17.2506 10.8763 16.709C10.6519 16.1675 10.5365 15.5871 10.5365 15.0009C10.5365 14.4147 10.6519 13.8343 10.8763 13.2928C11.1006 12.7513 11.4294 12.2592 11.8438 11.8447C12.2583 11.4302 12.7504 11.1015 13.2919 10.8771ZM12.8162 12.817C12.237 13.3962 11.9116 14.1818 11.9116 15.0009C11.9116 15.82 12.237 16.6056 12.8162 17.1848C13.3954 17.764 14.1809 18.0893 15 18.0893C15.8191 18.0893 16.6047 17.764 17.1839 17.1848C17.7631 16.6056 18.0885 15.82 18.0885 15.0009C18.0885 14.1818 17.7631 13.3962 17.1839 12.817C16.6047 12.2379 15.8191 11.9125 15 11.9125C14.1809 11.9125 13.3954 12.2379 12.8162 12.817Z"
            fill="#606061"
          />
        </svg>
      </AsideMenuListItem>
      <AsideMenuListButton
        class="px-[12px] my-[16px]"
        title="Добавить задачу"
        @click="shouldShowInspector"
      />
      <EventAlert
        v-if="licenseAlert"
        :tarif="user?.tarif"
      />
    </div>
  </aside>
</template>
<script>
import InspectorModalBox from '@/components/Inspector/InspectorModalBox.vue'
import InspectorLimit from '@/components/TasksList/InspectorLimit.vue'
import EventAlert from '@/components/EventAlert.vue'
import AsideMenuListItem from '@/components/AsideMenu/AsideMenuListItem.vue'
import AsideMenuListButton from '@/components/AsideMenu/AsideMenuListButton.vue'

import * as TASK from '@/store/actions/tasks.js'

export default {
  components: {
    InspectorLimit,
    EventAlert,
    InspectorModalBox,
    AsideMenuListItem,
    AsideMenuListButton
  },
  data: () => ({
    showFreeModal: false,
    showInspector: false
  }),
  computed: {
    user () {
      return this.$store.state.user.user
    },
    isAsideMobileExpanded () {
      return this.$store.state.isAsideMobileExpanded
    },
    activeTab () {
      return this.$store.state.navigator.submenu.activeTab
    },
    licenseAlert () {
      return (this.$store.getters.isLicenseExpired && this.user?.tarif === 'alpha') || (this.user?.tarif === 'free' || this.user?.tarif === 'trial')
    }
  },
  watch: {
    $route (to, from) {
      this.initActiveTab()
      if (this.isPropertiesMobileExpanded) {
        this.$store.dispatch('asidePropertiesToggle', false)
      }
      if (this.isAsideMobileExpanded) {
        this.$store.dispatch('asideMobileToggle', false)
      }
    }
  },
  mounted () {
    this.initActiveTab()
  },
  methods: {
    initActiveTab () {
      const allPaths = [
        'tasks',
        'account',
        'reglaments',
        'project',
        'board',
        'clients',
        'settings',
        'doitnow'
      ]
      for (let i = 0; i < allPaths.length; i++) {
        if (this.$route.path.includes(allPaths[i])) {
          this.$store.state.navigator.submenu.activeTab = allPaths[i]
          return
        }
      }
    },
    isPathSelected (code) {
      return this.activeTab === code
    },
    shouldShowInspector () {
      if ((this.user.tarif !== 'alpha' && this.user.tarif !== 'trial') || this.$store.getters.isLicenseExpired) {
        this.showFreeModal = true
        return
      }
      this.showInspector = true
    },
    selectTab (tab) {
      this.$store.state.navigator.submenu.activeTab = tab
      this.$store.state.navigator.submenu.status = false
    },
    changeTab (tab) {
      // изменение текущей вкладки
      if (tab === 'tasks') {
        this.$store.dispatch(TASK.DAYS_WITH_TASKS)
      }
      this.selectTab(tab)
      this.$store.state.navigator.submenu.status = true
    }
  }
}
</script>
